# üèÉ Server-side OptiMasFit

## **–ë—ç–∫–µ–Ω–¥-—á–∞—Å—Ç—å –¥–∏–ø–ª–æ–º–Ω–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞ OptiMasFit**

## üìë –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

1. üìù –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞
2. üõ†Ô∏è –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫
3. üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
4. üöÄ –£—Å—Ç–∞–Ω–æ–≤–∫–∞
5. ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
6. ‚ñ∂Ô∏è –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
7. üóÑÔ∏è –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∏ –º–∏–≥—Ä–∞—Ü–∏–∏
8. üåê API –∏ –º–∞—Ä—à—Ä—É—Ç—ã
9. üîÑ CI/CD

---

## üìù –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

–°–µ—Ä–≤–µ—Ä–Ω–∞—è —á–∞—Å—Ç—å OptiMasFit –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ —Ö—Ä–∞–Ω–µ–Ω–∏–µ, –æ–±—Ä–∞–±–æ—Ç–∫—É –∏ –ø–µ—Ä–µ–¥–∞—á—É –¥–∞–Ω–Ω—ã—Ö –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è—Ö, –∏—Ö —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞—Ö –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è—Ö. –°–µ—Ä–≤–∏—Å –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç:

* –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ DRF-—Ç–æ–∫–µ–Ω—ã
* CRUD-–æ–ø–µ—Ä–∞—Ü–∏–∏ –Ω–∞–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º–∏
* –ì–µ–Ω–µ—Ä–∞—Ü–∏—é –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—é —Å—Ö–µ–º—ã OpenAPI (Swagger)

## üõ†Ô∏è –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

* **–Ø–∑—ã–∫:** Python
* **–§—Ä–µ–π–º–≤–æ—Ä–∫:** Django, Django REST Framework
* **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö:** PostgreSQL
* **CI/CD:** GitHub Actions
* **–õ–∏–Ω—Ç–∏–Ω–≥:** flake8

## üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

```text
‚îî‚îÄoptimas-backend/
   ‚îú‚îÄ‚îÄ .github/                   # CI/CD workflow
   ‚îÇ   ‚îî‚îÄ‚îÄ workflows/ci.yml       # GitHub Actions
   ‚îú‚îÄ‚îÄ optimassfit/               # Django-–ø—Ä–æ–µ–∫—Ç
   ‚îÇ   ‚îú‚îÄ‚îÄ users/                 # –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ users
   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ migrations/        # –§–∞–π–ª—ã –º–∏–≥—Ä–∞—Ü–∏–π –ë–î
   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ admin.py           # –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –º–æ–¥–µ–ª–µ–π –≤ Django Admin
   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ api_urls.py        # –ú–∞—Ä—à—Ä—É—Ç—ã JSON-API –¥–ª—è DRF
   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ api_views.py       # ViewSet‚Äô—ã –∏ API-–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã
   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ apps.py            # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è users
   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ models.py          # –û–ø–∏—Å–∞–Ω–∏–µ –º–æ–¥–µ–ª–µ–π –¥–∞–Ω–Ω—ã—Ö (User, Profile, Recommendation)
   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ serializers.py     # –°–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è: –º–æ–¥–µ–ª–∏ ‚Üî JSON (–≤–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö)
   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ utils.py           # –£—Ç–∏–ª–∏—Ç—ã: –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π
   ‚îÇ   ‚îú‚îÄ‚îÄ asgi.py                # ASGI-–∫–æ–Ω—Ñ–∏–≥ –¥–ª—è async-–∑–∞–ø—Ä–æ—Å–æ–≤
   ‚îÇ   ‚îú‚îÄ‚îÄ settings.py            # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞
   ‚îÇ   ‚îú‚îÄ‚îÄ urls.py                # –û—Å–Ω–æ–≤–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã
   ‚îÇ   ‚îî‚îÄ‚îÄ wsgi.py                # WSGI-–∫–æ–Ω—Ñ–∏–≥ –¥–ª—è –¥–µ–ø–ª–æ—è
   ‚îú‚îÄ‚îÄ manage.py                  # –°–∫—Ä–∏–ø—Ç —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è Django
   ‚îú‚îÄ‚îÄ requirements.txt           # –°–ø–∏—Å–æ–∫ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
   ‚îî‚îÄ‚îÄ README.md                  # –¢–µ–∫—É—â–µ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ
```

## üöÄ –£—Å—Ç–∞–Ω–æ–≤–∫–∞

1. **–ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π**

   ```bash
   git clone https://github.com/Quant60/optimas-backend.git
   cd optimas-backend
   ```
2. **–°–æ–∑–¥–∞—Ç—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ –∏ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –µ–≥–æ**

   ```bash
   python -m venv .venv
   source .venv/bin/activate      # Linux/macOS
   .\.venv\Scripts\activate     # Windows
   ```
3. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏**

   ```bash
   pip install --upgrade pip
   pip install -r requirements.txt
   ```

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–ü—Ä–æ–µ–∫—Ç —á–∏—Ç–∞–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è:

| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è          | –û–ø–∏—Å–∞–Ω–∏–µ                                                 |
| ------------------- | -------------------------------------------------------- |
| `POSTGRES_DB`       | –ò–º—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö PostgreSQL (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `test_db` –≤ CI) |
| `POSTGRES_USER`     | –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ë–î (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `postgres`)                |
| `POSTGRES_PASSWORD` | –ü–∞—Ä–æ–ª—å –∫ –ë–î (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `postgres`)                    |
| `POSTGRES_HOST`     | –•–æ—Å—Ç –ë–î (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `localhost`)                       |
| `POSTGRES_PORT`     | –ü–æ—Ä—Ç –ë–î (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `5432`)                            |
| `DJANGO_SECRET_KEY` | –°–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á Django                                    |
| `DATABASE_URL`      | –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∞—è —Å—Ç—Ä–æ–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î                   |

–ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ñ–∞–π–ª `.env` –∏ –ø–∞–∫–µ—Ç `django-environ` –∏–ª–∏ `python-dotenv`.

## ‚ñ∂Ô∏è –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

```bash
python manage.py migrate --fake-initial  # –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏
python manage.py runserver              # –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–µ—Ä –Ω–∞ http://127.0.0.1:8000
```

## üóÑÔ∏è –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∏ –º–∏–≥—Ä–∞—Ü–∏–∏

* –ú–∏–≥—Ä–∞—Ü–∏–∏ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ `optimassfit/users/migrations`.
* –î–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ CI –ø—Ä–∏–º–µ–Ω—è–π—Ç–µ —Ñ–ª–∞–≥ `--fake-initial`.

## üåê API –∏ –º–∞—Ä—à—Ä—É—Ç—ã

### Web UI

* `GET /users/` ‚Äî —Å–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
* `POST /users/` ‚Äî —Å–æ–∑–¥–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

### JSON API

* `GET /api/users/` ‚Äî –ø–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
* `POST /api/users/` ‚Äî —Å–æ–∑–¥–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

–î–ª—è –ø–æ–ª–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞ —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤ —Å–º. `optimassfit/users/api_urls.py`.

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è OpenAPI

```bash
python manage.py spectacular --serve
```

–û—Ç–∫—Ä—ã—Ç—å –≤ –±—Ä–∞—É–∑–µ—Ä–µ: `http://127.0.0.1:8000/schema/`

## üîÑ CI/CD

–ù–∞—Å—Ç—Ä–æ–µ–Ω GitHub Actions (`.github/workflows/ci.yml`):

1. Checkout –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞ Python 3.12
2. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
3. –ü–æ–¥—ä—ë–º —Å–µ—Ä–≤–∏—Å–∞ PostgreSQL
4. –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π (`--fake-initial`)
5. –ó–∞–ø—É—Å–∫ flake8 (lint)
6. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ö–µ–º—ã OpenAPI
